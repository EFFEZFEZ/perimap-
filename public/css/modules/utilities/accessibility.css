/**
 * Accessibility Utilities - Perimap v504
 *
 * Extracted from public/style.css section 5 (Accessibility WCAG).
 * No rule changes; order preserved.
 * Source: public/style.css lines 562-673
 * Updated: 2026-01-24
 */

/* =========================================
 * ACCESSIBILITÉ WCAG - FOCUS VISIBLE
 * ========================================= */
button:focus-visible,
a:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
[role="button"]:focus-visible,
[tabindex]:not([tabindex="-1"]):focus-visible {
    outline: 3px solid var(--pm-green);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
}

/* Focus pour éléments dans fond sombre */
body.dark-theme button:focus-visible,
body.dark-theme a:focus-visible,
body.dark-theme input:focus-visible {
    outline-color: var(--pm-cyan);
}

/* Touch targets minimum 44x44px (WCAG 2.5.5) */
.btn-icon-round,
.btn-geolocate,
.btn-swap-direction,
button.btn-close,
button.tab {
    min-width: 44px;
    min-height: 44px;
}

/* Support prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

/* Dark theme - Aligné sur charte Périmap */
body.dark-theme {
    --bg-page: #0b1220;
    --bg-card: #0f1724;
    --bg-elevated: #151d2b;
    --bg-main: #0b1220;
    --bg-secondary: #0f1724;
    --bg-tertiary: #1a2332;
    --bg-light: #0b1220;
    --text-primary: #f1f5f9;
    --text-secondary: #cbd5e1;  /* Contraste amélioré WCAG 7:1 */
    --text-muted: #94a3b8;
    --border: rgba(255,255,255,0.08);
    --primary: var(--pm-green);
    --primary-dark: var(--pm-green-hover);
    --color-tab-active: var(--pm-green);
    --color-nav-condensed-bg: rgba(11, 18, 32, 0.95);
}

/* V490: Dark theme - fond solide sur html pour éviter zones grises Chrome */
html.dark-theme,
body.dark-theme {
    background-color: #0b1220;
}

/* Small visual adjustments in dark mode */
body.dark-theme #main-header {
    background: var(--bg-page);
    border-bottom-color: rgba(255,255,255,0.06);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* V628: IDENTITÉ VISUELLE - Style uniforme pour tous les blocs en dark mode */
body.dark-theme .card,
body.dark-theme .instruction-content,
body.dark-theme #horaires.view-active,
body.dark-theme #info-trafic.view-active,
body.dark-theme .itinerary-card,
body.dark-theme .result-card,
body.dark-theme #itinerary-edit-panel,
body.dark-theme .accordion-group,
body.dark-theme #fiche-horaire-container,
body.dark-theme .search-container,
body.dark-theme .search-prominent,
body.dark-theme .trafic-card,
body.dark-theme .stop-selector,
body.dark-theme .departures,
body.dark-theme .faq-card {
    background: rgba(15, 23, 42, 0.95) !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    border-radius: var(--radius-card, 16px) !important;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
}

body.dark-theme .leaflet-popup-content-wrapper {
    background: #0f172a !important;
    border-color: rgba(255,255,255,0.1) !important;
    backdrop-filter: blur(16px) !important;
    -webkit-backdrop-filter: blur(16px) !important;
}

body.dark-theme .leaflet-popup-tip {
    background: #0f172a !important;
}

/* V229: Popup arrêts complètement opaque en dark mode */
body.dark-theme .stop-schedule-popup .leaflet-popup-content-wrapper {
    background: #0f172a !important;
}
body.dark-theme .stop-schedule-popup .leaflet-popup-tip {
    background: #0f172a !important;
}
body.dark-theme .btn, body.dark-theme .btn-icon-round {
    background: rgba(255,255,255,0.02);
    color: var(--text-primary);
    border-color: rgba(255,255,255,0.04);
}
body.dark-theme .nav-button-condensed {
    color: white;
}
body.dark-theme #map { background: #06131b; }

