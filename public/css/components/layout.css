/* ═══════════════════════════════════════════════════════════════════════════
 * LAYOUT - View locking, scroll control, containers
 * ═══════════════════════════════════════════════════════════════════════════ */

/* Verrouille le scroll pour les vues plein écran */
body.view-is-locked {
    position: fixed;
    inset: 0;
    width: 100%;
    overflow: hidden;
}

/* Vue détail : bloquer TOUT scroll */
body.detail-view-open {
    position: fixed !important;
    inset: 0 !important;
    width: 100% !important;
    overflow: hidden !important;
    touch-action: none;
}

body.detail-view-open #site-footer,
body.detail-view-open #legal-strip {
    display: none !important;
}

/* Conteneurs de vue principaux */
#dashboard-container {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    height: auto;
    width: 100%;
    box-sizing: border-box;
    background: var(--bg-main);
    overflow-x: hidden;
    overflow-y: auto;
    overscroll-behavior-y: none;
    -webkit-overflow-scrolling: touch;
}

/* Vue carte plein écran */
#map-container {
    display: flex;
    flex-direction: column;
    flex: 1 0 auto;
    min-height: 0;
    height: 100%;
    background: var(--bg-light);
    position: relative;
}

#itinerary-results-container {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    height: auto;
    width: 100%;
    box-sizing: border-box;
    overflow-x: hidden;
    overflow-y: auto;
    overscroll-behavior-y: contain;
}

/* V66: Bloquer le scroll pour la vue carte */
body.view-map-locked {
    position: fixed;
    inset: 0;
    width: 100%;
    overflow: hidden;
    touch-action: none;
    overscroll-behavior: none;
    -webkit-overflow-scrolling: auto;
}

/* V368: Bloquer le scroll pour la vue itinéraire */
body.itinerary-view-active {
    position: fixed;
    inset: 0;
    width: 100%;
    overflow: hidden;
    touch-action: none;
    overscroll-behavior: none;
    -webkit-overflow-scrolling: auto;
}

/* V120: Vue carte plein écran sur mobile */
body.view-map-locked #map-container {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: var(--z-fixed);
    overflow: hidden;
    touch-action: none;
    overscroll-behavior: none;
}

body.view-map-locked #main-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: calc(var(--z-fixed) + 1);
    background: transparent;
}

body.view-map-locked #map-view {
    position: absolute;
    inset: 0;
    height: 100%;
}

body.view-map-locked #map {
    height: 100%;
    width: 100%;
}

/* Cacher scrollbar vue carte */
#map-container, #map-view, #map {
    scrollbar-width: none;
    -ms-overflow-style: none;
}
#map-container::-webkit-scrollbar,
#map-view::-webkit-scrollbar,
#map::-webkit-scrollbar {
    display: none;
}

.hidden { display: none !important; }

/* Cacher footer sur vues plein écran */
body.view-is-locked #main-header { display: none !important; }
body.view-is-locked #legal-strip { display: none !important; }

body.view-map-locked #site-footer,
body.view-map-locked #legal-strip { display: none !important; }

body.itinerary-view-active #site-footer,
body.itinerary-view-active #legal-strip { display: none !important; }

/* Mobile layout */
@media (max-width: 768px) {
    body {
        position: relative;
        overflow-x: hidden;
        overflow-y: auto;
        min-height: 100vh;
        height: auto;
    }
    
    #app-view-root {
        overflow-y: visible;
        -webkit-overflow-scrolling: touch;
        min-height: 100vh;
        height: auto;
    }
}
